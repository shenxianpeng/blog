---
title: å—å¤Ÿäº† Jenkinsfile æäº¤åæ‰æŠ¥é”™ï¼Ÿè¯•è¯•è¿™ä¸ªé¢„æ£€æŸ¥å·¥å…·ï¼
summary: Jenkinsfile æœ¬åœ°æ£€æŸ¥ç¥å™¨ï¼Œåˆ©ç”¨ API æ ¡éªŒï¼Œå®Œç¾æ”¯æŒ pre-commitã€‚
tags:
  - Jenkins
  - DevOps
translate: true
authors:
  - shenxianpeng
date: 2025-11-27
---

å¤§å®¶å¥½!

ä»Šå¤©æƒ³å’Œå¤§å®¶åˆ†äº«ä¸€ä¸ªæˆ‘æœ€è¿‘å¼€å‘çš„å¼€æºå°å·¥å…·ï¼š**jenkinsfilelint**ã€‚

#### **ä¸ºä»€ä¹ˆå†™è¿™ä¸ªå·¥å…·ï¼Ÿ**

ç›¸ä¿¡å†™è¿‡ Jenkins Pipeline çš„åŒå­¦éƒ½æœ‰è¿‡è¿™æ ·çš„ç—›è‹¦ç»å†ï¼š

1.  è¾›è¾›è‹¦è‹¦å†™å¥½äº† `Jenkinsfile`ã€‚
2.  æäº¤ä»£ç ï¼Œæ¨é€åˆ°ä»“åº“ã€‚
3.  ç›¯ç€ Blue Ocean æˆ– Console ç­‰å¾…æ„å»ºå¼€å§‹ã€‚
4.  **å´©ï¼** å‡ ç§’é’Ÿåæ„å»ºå¤±è´¥ï¼ŒåŸå› ç«Ÿç„¶æ˜¯å°‘äº†ä¸€ä¸ªæ‹¬å· `}` æˆ–è€…å…³é”®å­—æ‹¼å†™é”™è¯¯ã€‚
5.  ä¿®æ”¹ä»£ç  -\> å†æ¬¡æäº¤ -\> ç­‰å¾… -\> ç¥ˆç¥·...

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘åœ¨å¸‚é¢ä¸Šæ‰¾äº†ä¸€åœˆ Jenkinsfile çš„æ£€æŸ¥å·¥å…·ã€‚è™½ç„¶æœ‰ä¸€äº›ç°æˆçš„æ–¹æ¡ˆï¼Œä½†æˆ‘å‘ç°å®ƒä»¬è¦ä¹ˆé…ç½®ç¹çï¼Œè¦ä¹ˆ**æ— æ³•å¾ˆå¥½åœ°é›†æˆåˆ° `pre-commit` å·¥ä½œæµä¸­**ã€‚

æ—¢ç„¶æ²¡æœ‰é¡ºæ‰‹çš„å·¥å…·ï¼Œé‚£å°±è‡ªå·±é€ ä¸€ä¸ªå§ï¼äºæ˜¯å°±æœ‰äº† **jenkinsfilelint**ã€‚

#### **å®ƒæ˜¯ä»€ä¹ˆï¼Ÿ**

`jenkinsfilelint` æ˜¯ä¸€ä¸ªåŸºäº Python å¼€å‘çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œæ—¨åœ¨å¸®åŠ©ä½ åœ¨ä»£ç æäº¤å‰éªŒè¯ Jenkinsfile çš„è¯­æ³•æ­£ç¡®æ€§ã€‚

å®ƒé€šè¿‡è°ƒç”¨ Jenkins åŸç”Ÿçš„ API æ¥å£æ¥è¿›è¡Œæ ¡éªŒï¼Œå› æ­¤èƒ½å¤Ÿä¿è¯æ£€æŸ¥ç»“æœä¸å®é™…è¿è¡Œæ—¶çš„è§£æé€»è¾‘å®Œå…¨ä¸€è‡´ã€‚

**é¡¹ç›®åœ°å€ï¼š**

> [https://github.com/shenxianpeng/jenkinsfilelint](https://github.com/shenxianpeng/jenkinsfilelint)

#### **æ ¸å¿ƒç‰¹æ€§**

  * âœ… **åŸºäº Jenkins API**ï¼šåˆ©ç”¨ Jenkins å®˜æ–¹çš„ `/pipeline-model-converter/validate` æ¥å£ï¼Œæ ¡éªŒç»“æœä¸ä»…å‡†ç¡®ï¼Œè¿˜èƒ½æç¤ºå…·ä½“çš„é”™è¯¯è¡Œå·ã€‚
  * ğŸš€ **å®Œç¾æ”¯æŒ pre-commit**ï¼šè¿™æ˜¯æˆ‘å¼€å‘å®ƒçš„åˆè¡·ã€‚ä½ å¯ä»¥æŠŠå®ƒè½»æ¾é›†æˆåˆ°é¡¹ç›®çš„ git hooks ä¸­ï¼Œç¡®ä¿æ¯æ¬¡ commit å‰è‡ªåŠ¨æ£€æŸ¥ã€‚
  * ğŸ›  **é…ç½®çµæ´»**ï¼šæ”¯æŒé€šè¿‡ç¯å¢ƒå˜é‡æˆ–å‘½ä»¤è¡Œå‚æ•°é…ç½® Jenkins åœ°å€å’Œå‡­è¯ã€‚
  * ğŸ” **æ™ºèƒ½è¿‡æ»¤**ï¼šåœ¨ä½¿ç”¨ Jenkins Shared Library æ—¶ï¼Œä»“åº“é‡Œå¯èƒ½åŒ…å«çº¯ Groovy çš„è¾…åŠ©ç±»æ–‡ä»¶ï¼ˆä¸æ˜¯ Pipeline è„šæœ¬ï¼‰ã€‚å·¥å…·æ”¯æŒé€šè¿‡ `--skip` å‚æ•°è·³è¿‡è¿™äº›æ–‡ä»¶ï¼Œé¿å…è¯¯æŠ¥ã€‚

#### **å¦‚ä½•ä½¿ç”¨ï¼Ÿ**

##### 1\. å®‰è£…

ä½ å¯ä»¥ç›´æ¥ä½¿ç”¨ pip å®‰è£…ï¼š

```bash
pip install jenkinsfilelint
```

##### 2\. é›†æˆåˆ° pre-commitï¼ˆå¼ºçƒˆæ¨èï¼‰

åœ¨ä½ çš„é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºæˆ–ä¿®æ”¹ `.pre-commit-config.yaml` æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹é…ç½®ï¼š

```yaml
repos:
  - repo: https://github.com/shenxianpeng/jenkinsfilelint
    rev: v1.2.0  # å»ºè®®ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ tag
    hooks:
      - id: jenkinsfilelint
```

ç„¶åå®‰è£…é’©å­ï¼š

```bash
pre-commit install
```

##### 3\. é…ç½®å‡­è¯

ç”±äºæ ¡éªŒéœ€è¦è°ƒç”¨ Jenkins çš„ APIï¼Œä½ éœ€è¦æä¾› Jenkins çš„åœ°å€å’Œè®¿é—®å‡­è¯ã€‚

**âš ï¸ å®‰å…¨æç¤º**ï¼šå¼ºçƒˆå»ºè®®ä¸è¦å°†è´¦å·å¯†ç ç¡¬ç¼–ç åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼æ¨èä½¿ç”¨ç¯å¢ƒå˜é‡çš„æ–¹å¼ï¼š

```bash
# Linux/macOS
export JENKINS_URL=https://your-jenkins-instance.com
export JENKINS_USER=your-username
export JENKINS_TOKEN=your-api-token
```

é…ç½®å¥½ä¹‹åï¼Œå½“ä½ å°è¯•æ‰§è¡Œ `git commit` æ—¶ï¼Œ`jenkinsfilelint` å°±ä¼šè‡ªåŠ¨å¸®ä½ æ£€æŸ¥å˜æ›´ä¸­çš„ Jenkinsfile äº†ï¼

#### **å‘½ä»¤è¡Œæ‰‹åŠ¨æ£€æŸ¥**

å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨æœ¬åœ°æ‰‹åŠ¨è¿è¡Œå®ƒæ¥æ£€æŸ¥ç‰¹å®šæ–‡ä»¶ï¼š

```bash
# æ£€æŸ¥å•ä¸ªæ–‡ä»¶
jenkinsfilelint Jenkinsfile

# æ£€æŸ¥å¤šä¸ªæ–‡ä»¶
jenkinsfilelint Jenkinsfile Jenkinsfile.prod

# è·³è¿‡ç‰¹å®šæ¨¡å¼çš„æ–‡ä»¶ï¼ˆä¾‹å¦‚ src ç›®å½•ä¸‹çš„ Groovy æ–‡ä»¶ï¼‰
jenkinsfilelint --skip '*/src/*.groovy' Jenkinsfile src/Utils.groovy
```

#### **å†™åœ¨æœ€å**

è¿™ä¸ªé¡¹ç›®ç›®å‰å·²ç»å‘å¸ƒåœ¨ PyPI ä¸Šï¼Œæ¬¢è¿å¤§å®¶ä¸‹è½½è¯•ç”¨ã€‚

å¦‚æœä½ ä¹Ÿå—å¤Ÿäº† Jenkinsfile çš„â€œæäº¤åæŠ¥é”™â€ï¼Œä¸å¦¨è¯•è¯• `jenkinsfilelint`ã€‚å¦‚æœè§‰å¾—å¥½ç”¨ï¼Œæ¬¢è¿åœ¨ GitHub ä¸Šç‚¹ä¸ª **â­ï¸ Star** æ”¯æŒä¸€ä¸‹ï¼

å¦‚æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿æ Issue æˆ– PRã€‚

**GitHub ä¼ é€é—¨ï¼š**
[https://github.com/shenxianpeng/jenkinsfilelint](https://github.com/shenxianpeng/jenkinsfilelint)
