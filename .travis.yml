language: node_js

sudo: false

cache:
  apt: true
  directories:
    - node_modules

node_js:
  - "7"

before_script:
  - npm install
  - npm install -g hexo-cli
  - npm install hexo-deployer-git --save

jobs:
  include:
    - stage: Start local server
    script: 'cd blog && hexo server'
    - stage: Test local server
    script: 'curl http://localhost:4000/'
    deploy:
      provider: script
      on:
        branch: master