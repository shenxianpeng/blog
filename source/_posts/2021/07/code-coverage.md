---
title: 关于代码覆盖率 (About Code Coverage)
tags:
  - Coverage
  - DevOps
categories:
  - Coverage
date: 2021-07-14 22:49:39
author: shenxianpeng
---

## 什么是代码覆盖率？

代码覆盖率是对整个测试过程中被执行的代码的衡量。它能测量源代码中的哪些语句在测试中被执行，哪些语句尚未被执行。

## 为什么要测量代码覆盖率？

众所周知，测试可以提高软件版本的质量和可预测性。但是，你知道你的单元测试甚至是你的功能测试实际测试代码的效果如何吗？是否还需要更多的测试？

这些是代码覆盖率可以试图回答的问题。总之，出于以下原因我们需要测量代码覆盖率：

* 了解我们的测试用例对源代码的测试效果
* 了解我们是否进行了足够的测试
* 在软件的整个生命周期内保持测试质量

注：代码覆盖率不是灵丹妙药，覆盖率测量不能替代良好的代码审查和优秀的编程实践。

通常，我们应该采用合理的覆盖目标，力求在代码覆盖率在所有模块中实现均匀覆盖，而不是只看最终数字的是否高到令人满意。

举例：假设代码覆盖率只在某一些模块代码覆盖率很高，但在一些关键模块并没有足够的测试用例覆盖，那样虽然代码覆盖率很高，但并不能说明产品质量就很高。

## 代码覆盖率是符合工作的？

代码覆盖率测量有多种方法。 大体上有三种方法，可以组合使用：

**Source code instrumentation - 源代码检测**

这种方法将检测语句添加到源代码中，并使用正常的编译工具链编译代码以生成检测的程序集。

**Intermediate code instrumentation - 中间代码检测**

这里通过添加新的字节码来检测编译后的类文件，并生成一个新的检测类。

**Runtime information collection - 运行时信息收集**

这种方法在代码执行时从运行时环境收集信息以确定覆盖率信息。

## 当前主流代码覆盖率工具

代码覆盖率的工具有很多，以下是我用过的不同编程语言的代码覆盖率工具。在选择工具时，我力求去选择那些开源、流行（活跃）、好用的工具。

| 编程语言 | 代码覆盖率工具 |
| ----------- | ----------- |
| C/C++ | Gcov |
| Java | JaCoCo |
| JavaScript | Istanbul |
| Python | Coverage.py |
